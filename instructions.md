# AGP (Agentic Programming Project) Instructions

## System Purpose

AGP creates a standardized knowledge layer that enables any AI assistant to understand and work with a project without prior context. The `.agp` directory serves as persistent memory that accumulates project knowledge over time.

## Core Principle

**Any AI should be able to pick up any task in this project by reading the `.agp` directory.**

## Directory Structure

```
.agp/
├── instructions.md    # This file - System rules and AI workflows
├── architecture/      # Project structure and feature organization
│   ├── overview.md     # Index of all architecture files
│   └── ...            # Auto-generated architecture documentation
├── patterns/          # Implementation patterns and guidelines
│   ├── overview.md     # Index of all patterns
│   └── ...            # Auto-generated pattern documentation  
└── project/           # Knowledge for each source file
    └── ...            # Auto-generated .md files mirroring source structure
```

## AI Workflows

### Workflow 1: Modifying Existing Files

**Task**: "Refactor the Auth.tsx component"

**Steps**:
1. **Find knowledge**: Read `.agp/project/src/components/Auth.tsx.md`
2. **Follow links**: Read connected files mentioned in Dependencies and Related sections
3. **Modify code**: Make the requested changes to `src/components/Auth.tsx`
4. **Update knowledge**: Update `.agp/project/src/components/Auth.tsx.md` with new information

### Workflow 2: Adding New Features

**Task**: "Add user profile functionality"

**Steps**:
1. **Read overviews**: Start with `.agp/architecture/overview.md` and `.agp/patterns/overview.md`
2. **Study architecture**: Find relevant files like `feature-domains.md` to understand where similar features live
3. **Check patterns**: Look for implementation patterns that apply to this feature
4. **Create code**: Build new files following established patterns
5. **Document everything**: 
   - Create `.agp/project/` files for each new source file
   - Update overview files if new architecture/patterns emerge
   - Link all new knowledge to existing knowledge

## Knowledge File Format

### Standard Structure
Every source file must have a corresponding `.agp/project/{file-path}.md` with this structure:

```markdown
# {FileName}

## Purpose
- What this file does and why it exists

## Dependencies  
- **Input**: Files this depends on → .agp/project/{path}.md
- **Output**: Files that depend on this → .agp/project/{path}.md
- **External**: Third-party libraries

## Context
- How this fits into the larger system
- When/where this gets used

## Gotchas
- Common problems and edge cases
- Performance considerations

## Related
- **Patterns**: .agp/patterns/{pattern}.md
- **Architecture**: .agp/architecture/{topic}.md
- **Similar**: .agp/project/{similar-file}.md
```

### Example
```markdown
# Auth.tsx

## Purpose
- User login/logout UI component
- Form validation and API integration

## Dependencies
- **Input**: .agp/project/src/hooks/useAuth.tsx.md
- **Input**: .agp/project/src/api/auth.ts.md  
- **Output**: .agp/project/src/pages/Login.tsx.md
- **External**: react-hook-form

## Context
- Main authentication entry point
- Used in login and registration flows

## Gotchas
- Validation must complete before API call
- Clear all tokens on logout

## Related
- **Patterns**: .agp/patterns/form-handling.md
- **Architecture**: .agp/architecture/auth-flow.md
```

## Mandatory Rules

### Before Every Task
1. **Existing files**: Read `.agp/project/{file-path}.md` first
2. **New features**: Read `.agp/architecture/overview.md` and `.agp/patterns/overview.md` first
3. **Follow all links**: Don't skip connected knowledge

### After Every Task
1. **Update knowledge**: Modify affected `.agp/project/` files immediately
2. **Update overviews**: Add new files to relevant overview.md files
3. **Link everything**: Ensure new knowledge connects to existing knowledge
4. **Required**: Every source file MUST have corresponding `.agp/project/` documentation

### Knowledge Discovery
Use glob patterns to find knowledge:
```bash
# Specific file knowledge
.agp/project/src/components/Auth.tsx.md

# Explore directory
.agp/project/src/components/*.md

# Find all project knowledge  
.agp/project/**/*.md
```

## Success Criteria

The system works when:
- Any AI can work on any file without additional context
- Knowledge grows richer over time
- Patterns and architecture become clearer through documentation
- New team members can understand the project through `.agp` files

## Critical Notes

- The `.agp` directory is a Git submodule (separate from main codebase)
- All knowledge files are auto-generated by AI based on code analysis
- When in doubt, document more rather than less
- Keep knowledge files concise but comprehensive